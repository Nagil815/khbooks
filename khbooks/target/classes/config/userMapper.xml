<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="user">

	<!-- 회원가입 -->
	<insert id="u_ins" parameterType="dto.UserDTO">
		insert into kh_user(id, upass, uname, uemail, uphone, ubirth, ugender)
		values(#{id},#{upass},#{uname}, #{uemail}, #{uphone,jdbcType=VARCHAR}, #{ubirth,jdbcType=VARCHAR}, #{ugender})
	</insert>
	
	<!-- 아이디 중복확인 -->
	<select id="id_chk" parameterType="String" resultType="int">
		select count(*) from kh_user
		where id = #{id}
	</select>
	
	<!-- 이메일 중복확인 -->
	<select id="email_chk" parameterType="String" resultType="int">
		select count(*) from kh_user
		where uemail = #{uemail}
	</select>
	
	<!-- 아이디 찾기 -->
	<select id="find_id" parameterType="string" resultType="dto.UserDTO">
		select id from kh_user where uemail = #{uemail}
	</select>
	
	<!-- 로그인 -->
	<select id="login" resultType="dto.UserDTO">
		select * from kh_user where id = #{id} and upass =#{upass}
	</select>
	
	<!-- 네이버 로그인 -->
	<select id="naverInfo" parameterType="string" resultType="string">
		select id from kh_user where uemail = #{email}
	</select>
	
	<!-- 이메일 중복확인.. 인증번호 -->
	<update id="temp_pwd" parameterType="java.util.Map">
		update kh_user set upass = #{upass}
	  	where  id=#{id}
	</update>
	
	
	<!-- 이메일 중복확인.. 인증번호 -->
	<update id="authNum" parameterType="string">
		update kh_user set authnum=#{authnum}
	  	where  email=#{uemail}
	</update>
	
	<!-- 결제 -->
	<update id="pointupt" parameterType="map">
		update kh_user set point=point+#{coin} where id=#{id}
	</update>
	
	
	
	<!--카카오페이 전화번호 체크 -->
	<update id="phone_chk" parameterType="int">
		select count(*) from kh_user
		where tel = #{uphone}
	</update>
	

	
	<delete id="u_delete" parameterType="string" >
	  delete from kh_user
	  where id=#{id}
	</delete>
	
	


</mapper>   











