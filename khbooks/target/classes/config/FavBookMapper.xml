<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="FavBook">
	<select id="list" parameterType="map" 
	        resultType="dto.BookDTO">
		<![CDATA[
	 select b.* from
     (select rownum as rm, a.*  from (
     select b.bno, b.bname, b.bupdate, b.bgrade,b.bview, count(s.upno) as count
		from FAV_BOOk f , book b, serial s
		where f.id=#{id}
		AND f.bno=b.bno
		AND s.bno=f.bno
        group by b.BNO, b.bname, b.bupdate, b.bgrade, b.bview
        order by bno desc)a)b
     where b.rm>=#{pdto.startRow} and b.rm<=#{pdto.endRow}
	]]>
	</select>
	
	<delete id="delete" parameterType="map">
		delete from Fav_Book  where bno=#{bno} AND id#{id}
	</delete>
	
	<select id="count" parameterType="string" resultType="int">
		select count(*) from Fav_Book where id=#{id}
	</select>
	
	<select id="search" parameterType="map" resultType="int">
		select count(*) from fav_book where id=#{id} AND bno=#{bno} 
	</select>
	
	<insert id="insert" parameterType="map">
		insert into fav_book values(#{id},#{bno})
	</insert>

</mapper>

